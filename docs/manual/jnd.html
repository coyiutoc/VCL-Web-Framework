<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../">
  <title data-ice="title">Manual | VCL Framework</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
<script src="./inject/script/0-conditions-config.js"></script><script src="./inject/script/0-experiments-config.js"></script><script src="./inject/script/0-graphing-config.js"></script><script src="./inject/script/0-trial-structure-config.js"></script><script src="./inject/script/0-balancing-config.js"></script><script src="./inject/script/0-view-controller.js"></script><script src="./inject/script/0-experiments-renderer.js"></script><script src="./inject/script/0-conditions-renderer.js"></script><script src="./inject/script/0-supported-properties-renderer.js"></script><link rel="stylesheet" href="./inject/css/0-styles.css"><meta name="description" content="This is a Node.js application that runs proof of concept experiments for the following:"><meta property="twitter:card" content="summary"><meta property="twitter:title" content="VCL Framework"><meta property="twitter:description" content="This is a Node.js application that runs proof of concept experiments for the following:"></head>
<body class="layout-container manual-root" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
<a style="position:relative; top:3px;" href="https://github.com/coyiutoc/VCL_Correlation_POC"><img width="20px" src="./image/github.png"></a></header>

<nav class="navigation" data-ice="nav"><div class="manual-toc-root">
  
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/README.html"><a href="manual/README.html" data-ice="link">VCL Web Framework</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/README.html"><a href="manual/README.html#set-up" data-ice="link">Set Up</a></li>
<li data-ice="manualNav" class="indent-h4" data-link="manual/README.html"><a href="manual/README.html#-1--git-clone-the-repository" data-ice="link">(1) Git clone the repository</a></li>
<li data-ice="manualNav" class="indent-h4" data-link="manual/README.html"><a href="manual/README.html#-2--install-node" data-ice="link">(2) Install Node</a></li>
<li data-ice="manualNav" class="indent-h4" data-link="manual/README.html"><a href="manual/README.html#-3--install-dependencies" data-ice="link">(3) Install Dependencies</a></li>
<li data-ice="manualNav" class="indent-h4" data-link="manual/README.html"><a href="manual/README.html#-4--run-the-application" data-ice="link">(4) Run the Application</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/terminology.html"><a href="manual/terminology.html" data-ice="link">Terminology</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/terminology.html"><a href="manual/terminology.html#describing-an-experiment" data-ice="link">Describing an Experiment</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/terminology.html"><a href="manual/terminology.html#-strong-task--strong-" data-ice="link">Task</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/terminology.html"><a href="manual/terminology.html#-strong-method--strong-" data-ice="link">Method</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/terminology.html"><a href="manual/terminology.html#-strong-properties--strong-" data-ice="link">Properties</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/terminology.html"><a href="manual/terminology.html#condition-identifiers" data-ice="link">Condition Identifiers</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/terminology.html"><a href="manual/terminology.html#-strong-base-experiment--strong-" data-ice="link">Base Experiment</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/terminology.html"><a href="manual/terminology.html#-strong-trial-structure--strong-" data-ice="link">Trial Structure</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/terminology.html"><a href="manual/terminology.html#-strong-balancing--strong-" data-ice="link">Balancing</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/terminology.html"><a href="manual/terminology.html#-strong-condition--strong-" data-ice="link">Condition</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/experiments.html"><a href="manual/experiments.html" data-ice="link">Experiments</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/jnd.html"><a href="manual/jnd.html" data-ice="link">&gt;&gt; JND</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/jnd.html"><a href="manual/jnd.html#specifications" data-ice="link">Specifications</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/jnd.html"><a href="manual/jnd.html#practice-procedure" data-ice="link">Practice Procedure</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/jnd.html"><a href="manual/jnd.html#test-procedure" data-ice="link">Test Procedure</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/jnd.html"><a href="manual/jnd.html#jspsych-timeline" data-ice="link">JsPsych Timeline</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/jnd.html"><a href="manual/jnd.html#general-timeline" data-ice="link">General Timeline</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/jnd.html"><a href="manual/jnd.html#trial-logic" data-ice="link">Trial Logic</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/jnd.html"><a href="manual/jnd.html#adjusted-correlation" data-ice="link">Adjusted Correlation</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/jnd.html"><a href="manual/jnd.html#constants" data-ice="link">Constants</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/jnd_radius.html"><a href="manual/jnd_radius.html" data-ice="link">&gt;&gt; JND Radius</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/jnd_radius.html"><a href="manual/jnd_radius.html#specifications" data-ice="link">Specifications</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/jnd_radius.html"><a href="manual/jnd_radius.html#test-procedure" data-ice="link">Test Procedure</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/jnd_radius.html"><a href="manual/jnd_radius.html#constants" data-ice="link">Constants</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/stevens.html"><a href="manual/stevens.html" data-ice="link">&gt;&gt; Stevens</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/stevens.html"><a href="manual/stevens.html#specifications" data-ice="link">Specifications</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/stevens.html"><a href="manual/stevens.html#practice-procedure" data-ice="link">Practice Procedure</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/stevens.html"><a href="manual/stevens.html#test-procedure" data-ice="link">Test Procedure</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/stevens.html"><a href="manual/stevens.html#jspsych-timeline" data-ice="link">JsPsych Timeline</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/stevens.html"><a href="manual/stevens.html#trial-logic" data-ice="link">Trial Logic</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/stevens.html"><a href="manual/stevens.html#estimated-correlation" data-ice="link">Estimated Correlation</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/stevens.html"><a href="manual/stevens.html#constants" data-ice="link">Constants</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/estimation.html"><a href="manual/estimation.html" data-ice="link">&gt;&gt; Estimation</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/estimation.html"><a href="manual/estimation.html#specifications" data-ice="link">Specifications</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/supported_properties.html"><a href="manual/supported_properties.html" data-ice="link">Supported Properties</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/supported_properties.html"><a href="manual/supported_properties.html#identifiers" data-ice="link">Identifiers</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/supported_properties.html"><a href="manual/supported_properties.html#base-experiment" data-ice="link">Base Experiment</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/supported_properties.html"><a href="manual/supported_properties.html#trial-structure" data-ice="link">Trial Structure</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/supported_properties.html"><a href="manual/supported_properties.html#balancing" data-ice="link">Balancing</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/supported_properties.html"><a href="manual/supported_properties.html#graph-types" data-ice="link">Graph Types</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/supported_properties.html"><a href="manual/supported_properties.html#subcondition-attributes" data-ice="link">Subcondition Attributes</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/supported_properties.html"><a href="manual/supported_properties.html#experimental-attributes" data-ice="link">Experimental Attributes</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/supported_properties.html"><a href="manual/supported_properties.html#graphical-attributes" data-ice="link">Graphical Attributes</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/conditions.html"><a href="manual/conditions.html" data-ice="link">Conditions</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/developing_new_conditions.html"><a href="manual/developing_new_conditions.html" data-ice="link">Developing New Conditions</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/developing_new_conditions.html"><a href="manual/developing_new_conditions.html#for-researchers" data-ice="link">For Researchers</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/developing_new_conditions.html"><a href="manual/developing_new_conditions.html#example" data-ice="link">Example</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/developing_new_conditions.html"><a href="manual/developing_new_conditions.html#for-developers" data-ice="link">For Developers</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/developing_new_conditions.html"><a href="manual/developing_new_conditions.html#-1--add-to-config" data-ice="link">(1) Add to config</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/developing_new_conditions.html"><a href="manual/developing_new_conditions.html#-2--add-subconditions" data-ice="link">(2) Add subconditions</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/developing_new_conditions.html"><a href="manual/developing_new_conditions.html#-3--update-instructions" data-ice="link">(3) Update instructions</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/developing_new_conditions.html"><a href="manual/developing_new_conditions.html#-4--update-docs" data-ice="link">(4) Update docs</a></li>
</ul>
  </div>
<div data-ice="manual">
    <ul class="manual-toc">
      
    <li data-ice="manualNav" class="indent-h1" data-link="manual/developing_new_properties.html"><a href="manual/developing_new_properties.html" data-ice="link">Developing New Properties</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/developing_new_properties.html"><a href="manual/developing_new_properties.html#trial-structures" data-ice="link">Trial Structures</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/developing_new_properties.html"><a href="manual/developing_new_properties.html#balancing-types" data-ice="link">Balancing Types</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/developing_new_properties.html"><a href="manual/developing_new_properties.html#graph-related" data-ice="link">Graph-Related</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/developing_new_properties.html"><a href="manual/developing_new_properties.html#graphical-attributes" data-ice="link">Graphical Attributes</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/developing_new_properties.html"><a href="manual/developing_new_properties.html#graph-types" data-ice="link">Graph Types</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/developing_new_properties.html"><a href="manual/developing_new_properties.html#adding-experiments" data-ice="link">Adding Experiments</a></li>
<li data-ice="manualNav" class="indent-h2" data-link="manual/developing_new_properties.html"><a href="manual/developing_new_properties.html#overriding" data-ice="link">Overriding</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/developing_new_properties.html"><a href="manual/developing_new_properties.html#base-plots" data-ice="link">Base Plots</a></li>
<li data-ice="manualNav" class="indent-h3" data-link="manual/developing_new_properties.html"><a href="manual/developing_new_properties.html#trial-structures" data-ice="link">Trial Structures</a></li>
</ul>
  </div>
</div>
</nav>

<div class="content" data-ice="content"><div class="github-markdown" data-ice="content"><h1 id="-gt--gt--jnd">&gt;&gt; JND</h1><ul>
<li><strong>Task</strong>: Discrimination</li>
<li><strong>Method</strong>: Forced choice with Staircase</li>
</ul>
<h2 id="specifications">Specifications</h2><p><strong>_</strong>Note that all CAPPED variables are constants taken from the excel sheets/data file.<strong>_</strong></p>
<ul>
<li>For a given subcondition, there are at minimum 24 trials and at maximum 52. Once a user has reached the 24th trial, we start computing for convergence by calculating an F-value to see if it is lower than the threshold. <ul>
<li>If the F-value is &lt; <code>(1-CONVERGENCE_THRESHOLD)</code>, then the current subcondition ends, and proceeds to the next subcondition.</li>
<li>If the F-value is &gt;= <code>(1-CONVERGENCE_THRESHOLD)</code>, then the trials continue.</li>
</ul>
</li>
</ul>
<h3 id="practice-procedure">Practice Procedure</h3><ul>
<li>We choose 4 subconditions randomly, and let the participant run through those. It otherwise follows the same procedure like the test detailed below.</li>
</ul>
<h3 id="test-procedure">Test Procedure</h3><ul>
<li>For a given subcondition&apos;s trial:<ul>
<li>The BASE_CORRELATION for that subcondition will be used to calculate the distribution of one plot, but we need to calculate the adjusted correlation on a trial-by-trial basis.<ul>
<li><em>At the first presentation of a trial</em>, there is a need to compute the adjusted correlation. <ul>
<li>If converging from above, we calculate it by: <code>Math.min(MAX_CORRELATION, BASE_CORRELATION + INITIAL_DIFFERENCE)</code></li>
<li>If converging from below, we calculate it by: <code>Math.max(MAX_CORRELATION, BASE_CORRELATION - INITIAL_DIFFERENCE)</code></li>
</ul>
</li>
<li><em>If this is NOT the first presentation of a trial</em>, then use the <strong>staircase method</strong> to calculate the adjusted correlation. <ul>
<li>If converging from above:<ul>
<li>If the <strong>previous</strong> trial was correct, adjusted correlation = <code>Math.max(INITIAL_DIFFERENCE, previous adjusted correlation - MAX_STEP_SIZE)</code></li>
<li>If the <strong>previous</strong> trial was incorrect, adjusted correlation = <code>Math.min(MAX_CORRELATION, previous adjusted correlation + MAX_STEP_SIZE * INCORRECT_MULTIPLIER)</code></li>
</ul>
</li>
<li>If converging from below:<ul>
<li>If the <strong>previous</strong> trial was correct, adjusted correlation = <code>Math.min(INITIAL_DIFFERENCE, previous adjusted correlation + MAX_STEP_SIZE)</code></li>
<li>If the <strong>previous</strong> trial was incorrect, adjusted correlation = <code>Math.max(MIN_CORRELATION, previous adjusted correlation - MAX_STEP_SIZE * INCORRECT_MULTIPLIER)</code></li>
</ul>
</li>
</ul>
</li>
<li>Generate a gaussian distribution using the BASE_CORRELATION and adjusted correlation.</li>
<li>Plot each distribution onto a separate plot, and randomize whether the right/left plots get the base or adjusted correlation. The manner in which the distribution is plotted varies depending on the type of plot. For example:<ul>
<li>For a conventional strip, the x coordinate defines the horizontal translation while the y coordinate determines the height of the &quot;strip&quot;.</li>
<li>For a conventional ring, the x coordinate defines the horizontal translation while the y coordinate determines the radius of the &quot;ring&quot;.</li>
</ul>
</li>
<li>A user can make keyboard inputs with the &quot;z&quot; or &quot;m&quot; keys. &quot;z&quot; corresponds to the left graph, &quot;m&quot; corresponds to the right graph.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="jspsych-timeline">JsPsych Timeline</h2><h3 id="general-timeline">General Timeline</h3><pre><code><code class="source-code prettyprint">- Display instructions
- Ready screen
- Display JND practice trials {
    For a given JND experiment, continue to display trials if: 
    - There are still more practice subconditions
  }  
- Stop screen
- Ready screen
- Display JND test trials {
    For a given JND experiment, continue to display trials if: 
    - There are still more test subconditions
  }  
- Stop screen with data download options</code>
</code></pre><h3 id="trial-logic">Trial Logic</h3><p>Within the trial object, all computations for distributions and constants are performed in the <code>on_start()</code> function. This means that prior to a trial executing, we perform ALL operations detailed in this function. This trial object can be found on line 120 in <code>scripts/experiments/jnd.js</code>. </p>
<p>In general, this is what is executed:</p>
<pre><code class="lang-javascript"><code class="source-code prettyprint">on_start: function(){

  // Retrieve the constants (i.e variables listed in the section below) for the given subcondition index i
  var constants = get_constants_for_subcondition(i); 

  // Calculate adjusted correlation
  // (Refer to next section for pseudocode of this function)
  var adjusted_correlation = calculate_adjusted_correlation(constants);

  // Save all relevant constants of this trial to the JsPsych data object
  handle_data_saving(constants); 

  var base_coordinates = generate_distribution(constants.BASE_CORRELATION, 
                                               constants.ERROR, 
                                               constants.NUM_POINTS, 
                                               constants.NUM_SD, 
                                               constants.MEAN,
                                               constants.SD);

  var adjusted_coordinates = generate_distribution(adjusted_correlation, 
                                               constants.ERROR, 
                                               constants.NUM_POINTS, 
                                               constants.NUM_SD, 
                                               constants.MEAN,
                                               constants.SD);

  // Randomize position of the base/adjusted correlations to be either left/right
  // and keep these positions constant for a given subcondition
  var result = randomize_position(base_coordinates, adjusted_coordinates);

  // Set these correlations to the global D3 variables used for plotting
  left_coordinates = result.left;
  right_coordinates = result.right; 

} </code>
</code></pre>
<h3 id="adjusted-correlation">Adjusted Correlation</h3><p>Below is the pseudocode for how the adjusted correlation value is generated for a given trial. </p>
<pre><code class="lang-javascript"><code class="source-code prettyprint">
var MIN_CORRELATION = 0.0;
var MAX_CORRELATION = 1.0;
var INCORRECT_MULTIPLIER = 3;

function calculate_adjusted_correlation(constants){

   // If first trial, compute solely using constants:
   if (this_is_the_first_trial()){
      var adjusted_correlation = initialize_adjusted_statistic(constants.CONVERGE_FROM_ABOVE,
                                                               constants.BASE_CORRELATION, 
                                                               constants.INITIAL_DIFFERENCE);
   }
   // If not first trial, data from previous trial is needed:
   else{
     var last_JND_trial = get_data_from_last_trial();

     var adjusted_correlation = get_next_adjusted_statistic(last_JND_trial.correct,
                                                            constants.CONVERGE_FROM_ABOVE,
                                                            last_JND_trial.adjusted_correlation,
                                                            constants.BASE_CORRELATION,
                                                            constants.MAX_STEP_SIZE);
   }
   return adjusted_correlation;
}

function initialize_adjusted_statistic(converge_from_above, base_correlation, initial_difference){

  var adjusted_correlation;

  if (converge_from_above){
    adjusted_correlation = Math.min(MAX_CORRELATION, base_correlation + initial_difference); }
  else{
    adjusted_correlation = Math.max(MIN_CORRELATION, base_correlation - initial_difference);
  };

  return adjusted_correlation;
}

function get_next_adjusted_statistic(correct, converge_from_above, adjusted_quantity, base_correlation, max_step_size){

  var next_adjusted_statistic;

  var initial_difference = base_correlation;

  if (converge_from_above) {
    if (correct) {
      next_adjusted_statistic = Math.max(initial_difference, adjusted_quantity - max_step_size);
    } else {
      next_adjusted_statistic = Math.min(MAX_CORRELATION, adjusted_quantity + max_step_size
                                * INCORRECT_MULTIPLIER);
    }
  } else {
    if (correct) {
      next_adjusted_statistic = Math.min(initial_difference, adjusted_quantity + max_step_size);
    } else {
      next_adjusted_statistic = Math.max(MIN_CORRELATION, adjusted_quantity - max_step_size
                                * INCORRECT_MULTIPLIER);
    }
  }

  return next_adjusted_statistic;
}</code>
</code></pre>
<h3 id="constants">Constants</h3><p>These are the constants extracted from the input excel sheets. The values of these constants differ for each sub condition.</p>
<ul>
<li>BASE_CORRELATION</li>
<li>ERROR</li>
<li>MAX_STEP_SIZE</li>
<li>CONVERGE_FROM_ABOVE</li>
<li>INITIAL_DIFFERENCE</li>
<li>NUM_POINTS</li>
<li>MEAN</li>
<li>SD</li>
<li>NUM_SD</li>
</ul>
</div>
</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.1.0)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
