<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../../../">
  <title data-ice="title">scripts/experiments/jnd/jnd_timeline.js | VCL Framework</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
<script src="./inject/script/0-conditions-config.js"></script><script src="./inject/script/0-experiments-config.js"></script><script src="./inject/script/0-graphing-config.js"></script><script src="./inject/script/0-trial-structure-config.js"></script><script src="./inject/script/0-balancing-config.js"></script><script src="./inject/script/0-view-controller.js"></script><script src="./inject/script/0-experiments-renderer.js"></script><script src="./inject/script/0-conditions-renderer.js"></script><script src="./inject/script/0-supported-properties-renderer.js"></script><meta name="description" content="This is a Node.js application that runs proof of concept experiments for the following:"><meta property="twitter:card" content="summary"><meta property="twitter:title" content="VCL Framework"><meta property="twitter:description" content="This is a Node.js application that runs proof of concept experiments for the following:"></head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
<a style="position:relative; top:3px;" href="https://github.com/coyiutoc/VCL_Correlation_POC"><img width="20px" src="./image/github.png"></a></header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#experiment-properties-balancing">experiment-properties/balancing</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-initialize_latin_square">initialize_latin_square</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-initialize_random_order">initialize_random_order</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#experiment-properties-data">experiment-properties/data</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-get_subconditions">get_subconditions</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-create_condition_dataset">create_condition_dataset</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-get_data">get_data</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-get_data_subset">get_data_subset</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-CUSTOM_TRIAL_STRUCTURE_CONDITIONS">CUSTOM_TRIAL_STRUCTURE_CONDITIONS</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-EXPERIMENT_BASES">EXPERIMENT_BASES</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-EXPERIMENT_CONDITIONS">EXPERIMENT_CONDITIONS</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#experiment-properties-data-constants">experiment-properties/data/constants</a><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-ESTIMATION_BASE">ESTIMATION_BASE</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-JND_BASE">JND_BASE</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-JND_CONDITIONS">JND_CONDITIONS</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-JND_RADIUS_BASE">JND_RADIUS_BASE</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-JND_RADIUS_CONDITIONS">JND_RADIUS_CONDITIONS</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-STEVENS_BASE">STEVENS_BASE</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-STEVENS_CONDITIONS">STEVENS_CONDITIONS</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#experiment-properties-graphing">experiment-properties/graphing</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-is_custom_plot">is_custom_plot</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-prepare_custom_plot">prepare_custom_plot</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-plot_distributions">plot_distributions</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#experiment-properties-graphing-d3-base-plots">experiment-properties/graphing/d3-base-plots</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-create_ring_plot">create_ring_plot</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-create_scatter_plot">create_scatter_plot</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-plot_scatter_points">plot_scatter_points</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-create_shape_plot">create_shape_plot</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-create_strip_plot">create_strip_plot</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#experiment-properties-graphing-d3-custom-plots">experiment-properties/graphing/d3-custom-plots</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-create_distractor_scatter_plot">create_distractor_scatter_plot</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#experiments-estimation">experiments/estimation</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/scripts/experiments/estimation/estimation.js~Estimation.html">Estimation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-estimation_exp">estimation_exp</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#experiments-jnd">experiments/jnd</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/scripts/experiments/jnd/jnd.js~JND.html">JND</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-jnd_exp">jnd_exp</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#experiments-jnd-radius">experiments/jnd_radius</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/scripts/experiments/jnd_radius/jnd_radius.js~JND_Radius.html">JND_Radius</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-jnd_radius_exp">jnd_radius_exp</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#experiments-stevens">experiments/stevens</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/scripts/experiments/stevens/stevens.js~Stevens.html">Stevens</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-stevens_exp">stevens_exp</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#helpers">helpers</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-force_greater_right_position">force_greater_right_position</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-randomize_position">randomize_position</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-randomize_radius_position">randomize_radius_position</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">scripts/experiments/jnd/jnd_timeline.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">import JND from &quot;/scripts/experiments/jnd/jnd.js&quot;;
export var jnd_exp = new JND(params);

var timeline = [];
var address = location.protocol + &quot;//&quot; + location.hostname + &quot;:&quot; + location.port; 

// =========================================================
// WELCOME TRIAL BLOCK

var welcome = {
  type: &apos;html-keyboard-response&apos;,
  stimulus: `&lt;div align = &quot;center&quot;&gt;` + `&lt;img src=&quot;${address}/img/VCL_lab_logo.png&quot;&gt;&lt;/img&gt;&lt;br&gt;&lt;br&gt;` +
            `&lt;b&gt;Base:&lt;/b&gt; JND` + &apos;&lt;br&gt;&apos; + 
            `&lt;b&gt;Trial Type:&lt;/b&gt; ${jnd_exp.trial_structure}` + &apos;&lt;br&gt;&apos; + 
            `&lt;b&gt;Graph Type:&lt;/b&gt; ${jnd_exp.graph_type}` + &apos;&lt;br&gt;&apos; + 
            `&lt;b&gt;Condition:&lt;/b&gt; ${jnd_exp.condition_name}` + 
            &apos;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;p&gt;&lt;font size = 15&gt;Press any key to begin.&lt;p&gt;&lt;/font&gt;&apos; +
            &apos;&lt;/div&gt;&apos;,
  data: {type: &apos;instruction&apos;}
};
timeline.push(welcome);

// =========================================================
// INSTRUCTION TRIAL BLOCKS

switch(jnd_exp.graph_type){
  case &quot;scatter&quot;:

    if (jnd_exp.condition_name === &quot;distractor_multi&quot; || jnd_exp.condition_name === &quot;distractor_rainbow&quot;) {
      var instructions = {
      type: &quot;html-keyboard-response&quot;,
      stimulus: &quot;&lt;div align = &apos;center&apos;&gt; &lt;p&gt;In this experiment, two graphs will appear side-by-side.&quot; + 
          &quot;&lt;br&gt; Indicate which graph is more correlated by pressing the Z or M key. &lt;/p&gt;&lt;p&gt;&quot; +
          &quot;&lt;div style=&apos;height: 290px; width: 700px; display: block;&apos;&gt;&quot;+
          `&lt;div style=&apos;float: left;&apos;&gt;&lt;img src=&apos;${address}/img/sample_multi_distractor_1.png&apos;&gt;&lt;/img&gt;` +
          &quot;&lt;p class=&apos;small&apos;&gt;&lt;strong&gt;Press the Z key&lt;/strong&gt;&lt;/p&gt;&lt;/div&gt;&quot; +
          `&lt;div style=&apos;float: right;&apos;&gt;&lt;img src=&apos;${address}/img/sample_multi_distractor_2.png&apos;&gt;&lt;/img&gt;` +
          &quot;&lt;p class=&apos;small&apos;&gt;&lt;strong&gt;Press the M key&lt;/strong&gt;&lt;/p&gt;&lt;/div&gt;&quot; +
          &quot;&lt;/div&gt;&quot; + &quot;&lt;div&gt; &lt;br&gt;&lt;p&gt;Press any key to continue.&lt;/p&gt; &lt;/div&gt;&quot; + 
          &quot;&lt;/div&gt;&quot;          
      };
    }
    else if (jnd_exp.condition_name === &quot;distractor_ratio_pilot&quot;) {
      var instructions = {
      type: &quot;html-keyboard-response&quot;,
      stimulus: &quot;&lt;div align = &apos;center&apos;&gt; &lt;p&gt;In this experiment, two graphs will appear side-by-side.&quot; + 
          &quot;&lt;br&gt; Indicate whether the graph with &lt;font color=&apos;BLUE&apos;&gt;blue&lt;/font&gt; points is more correlated by pressing the Z or M key. &lt;/p&gt;&lt;p&gt;&quot; +
          &quot;&lt;div style=&apos;height: 290px; width: 700px; display: block;&apos;&gt;&quot;+
          `&lt;div style=&apos;float: left;&apos;&gt;&lt;img src=&apos;${address}/img/sample_distractor_ratio_1.png&apos;&gt;&lt;/img&gt;` +
          &quot;&lt;p class=&apos;small&apos;&gt;&lt;strong&gt;Press the Z key&lt;/strong&gt;&lt;/p&gt;&lt;/div&gt;&quot; +
          `&lt;div style=&apos;float: right;&apos;&gt;&lt;img src=&apos;${address}/img/sample_distractor_ratio_2.png&apos;&gt;&lt;/img&gt;` +
          &quot;&lt;p class=&apos;small&apos;&gt;&lt;strong&gt;Press the M key&lt;/strong&gt;&lt;/p&gt;&lt;/div&gt;&quot; +
          &quot;&lt;/div&gt;&quot; + &quot;&lt;div&gt; &lt;br&gt;&lt;p&gt;Press any key to continue.&lt;/p&gt; &lt;/div&gt;&quot; + 
          &quot;&lt;/div&gt;&quot;          
      };
    }
    else if (jnd_exp.condition_group === &quot;distractor&quot; &amp;&amp; jnd_exp.condition_name.split(&quot;_&quot;)[2] === &quot;shades&quot;){
      var instructions = {
      type: &quot;html-keyboard-response&quot;,
      stimulus: &quot;&lt;div align = &apos;center&apos;&gt; &lt;p&gt;In this experiment, two graphs will appear side-by-side.&quot; + 
          &quot;&lt;br&gt; Indicate which graph is more correlated by pressing the Z or M key. &lt;/p&gt;&lt;p&gt;&quot; +
          &quot;&lt;div style=&apos;height: 290px; width: 700px; display: block;&apos;&gt;&quot;+
          `&lt;div style=&apos;float: left;&apos;&gt;&lt;img src=&apos;${address}/img/sample_distractor_shades_1.png&apos;&gt;&lt;/img&gt;` +
          &quot;&lt;p class=&apos;small&apos;&gt;&lt;strong&gt;Press the Z key&lt;/strong&gt;&lt;/p&gt;&lt;/div&gt;&quot; +
          `&lt;div style=&apos;float: right;&apos;&gt;&lt;img src=&apos;${address}/img/sample_distractor_shades_2.png&apos;&gt;&lt;/img&gt;` +
          &quot;&lt;p class=&apos;small&apos;&gt;&lt;strong&gt;Press the M key&lt;/strong&gt;&lt;/p&gt;&lt;/div&gt;&quot; +
          &quot;&lt;/div&gt;&quot; + &quot;&lt;div&gt; &lt;br&gt;&lt;p&gt;Press any key to continue.&lt;/p&gt; &lt;/div&gt;&quot; + 
          &quot;&lt;/div&gt;&quot;          
      };
    }
    else if (jnd_exp.condition_group === &quot;distractor&quot;) {

      let name_split_array = jnd_exp.condition_name.split(&quot;_&quot;);
      let target = &quot;&quot;;
      let color = &quot;&quot;;
      let axis = &quot;&quot;;

      if (name_split_array.length === 4){
        target = name_split_array[1];
        color = name_split_array[2];
        axis = name_split_array[3];
      } else {
        target = name_split_array[1];
        color = name_split_array[3];
        axis = name_split_array[4];

      }

      var instructions = {
      type: &quot;html-keyboard-response&quot;,
      stimulus: `&lt;div align = &apos;center&apos;&gt;In this experiment, two graphs will appear side-by-side. 
                 &lt;br&gt; 
                 Indicate which graph has a higher correlation of the &lt;b&gt;target-colored&lt;/b&gt; ${target}s by pressing the Z or M key. 
                 &lt;br&gt;
                 Ignore any squares with a &lt;b&gt;distractor&lt;/b&gt; color.
                 &lt;br&gt;
                 &lt;br&gt;
                 &lt;img src=&apos;${address}/img/distractors/target-distractors/${color}_${axis}.png&apos;&gt;&lt;/img&gt;
                 &lt;br&gt;
                &lt;div style=&apos;height: 43vh; display: block;&apos;&gt;
                  &lt;div style=&apos;float: left;&apos;&gt;
                    &lt;img src=&apos;${address}/img/distractors/plots/sample_distractor_${color}_1.png&apos;&gt;&lt;/img&gt;
                    &lt;p class=&apos;small&apos;&gt;&lt;strong&gt;Press the Z key&lt;/strong&gt;&lt;/p&gt;
                  &lt;/div&gt;
                &lt;div style=&apos;float: right;&apos;&gt;
                  &lt;img src=&apos;${address}/img/distractors/plots/sample_distractor_${color}_2.png&apos;&gt;&lt;/img&gt;
                  &lt;p class=&apos;small&apos;&gt;&lt;strong&gt;Press the M key&lt;/strong&gt;&lt;/p&gt;&lt;/div&gt;
                &lt;/div&gt;
                &lt;div&gt; 
                  &lt;br&gt;
                  &lt;p&gt;Press any key to continue.&lt;/p&gt; 
                &lt;/div&gt;
                `        
      };
    } else {
      var instructions = {
      type: &quot;html-keyboard-response&quot;,
      stimulus: &quot;&lt;div align = &apos;center&apos;&gt; &lt;p&gt;In this experiment, two graphs will appear side-by-side.&quot; + 
          &quot;&lt;br&gt; Indicate which graph is more correlated by pressing the Z or M key. &lt;/p&gt;&lt;p&gt;&quot; +
          &quot;&lt;div style=&apos;height: 290px; width: 700px; display: block;&apos;&gt;&quot;+
          `&lt;div style=&apos;float: left;&apos;&gt;&lt;img src=&apos;${address}/img/sample_scatter_1.png&apos;&gt;&lt;/img&gt;` +
          &quot;&lt;p class=&apos;small&apos;&gt;&lt;strong&gt;Press the Z key&lt;/strong&gt;&lt;/p&gt;&lt;/div&gt;&quot; +
          `&lt;div style=&apos;float: right;&apos;&gt;&lt;img src=&apos;${address}/img/sample_scatter_2.png&apos;&gt;&lt;/img&gt;` +
          &quot;&lt;p class=&apos;small&apos;&gt;&lt;strong&gt;Press the M key&lt;/strong&gt;&lt;/p&gt;&lt;/div&gt;&quot; +
          &quot;&lt;/div&gt;&quot; + &quot;&lt;div&gt; &lt;br&gt;&lt;p&gt;Press any key to continue.&lt;/p&gt; &lt;/div&gt;&quot; + 
          &quot;&lt;/div&gt;&quot;          
      };
    }
    break;

  case &quot;strip&quot;:
    if (jnd_exp.condition_name === &quot;line_length_strip&quot;) {
      var instructions = {
      type: &quot;html-keyboard-response&quot;,
      stimulus: &quot;&lt;div align = &apos;center&apos;&gt; &lt;p&gt;In this experiment, two graphs will appear one on top of the other.&quot; + 
          &quot;&lt;br&gt; Indicate which graph is more correlated by pressing the Z or M key. &lt;/p&gt;&lt;p&gt;&quot; +
          &quot;&lt;strong&gt;Press the Z key if the graph &lt;u&gt;above&lt;/u&gt; is more correlated.&lt;/strong&gt;&quot; +
          `&lt;div style=&apos;float: center; display: block;&apos;&gt;&lt;img src=&apos;${address}/img/sample_line_length_strip.png&apos;&gt;&lt;/img&gt;&lt;/div&gt;` +
          &quot;&lt;strong&gt;Press the M key if the graph &lt;u&gt;below&lt;/u&gt; is more correlated.&lt;/strong&gt;&quot;
      };
    } else {
      var instructions = {
      type: &quot;html-keyboard-response&quot;,
      stimulus: &quot;&lt;div align = &apos;center&apos;&gt; &lt;p&gt;In this experiment, two graphs will appear one on top of the other.&quot; + 
          &quot;&lt;br&gt; Indicate which graph is more correlated by pressing the Z or M key. &lt;/p&gt;&lt;p&gt;&quot; +
          &quot;&lt;strong&gt;Press the Z key if the graph &lt;u&gt;above&lt;/u&gt; is more correlated.&lt;/strong&gt;&quot; +
          `&lt;div style=&apos;float: center; display: block;&apos;&gt;&lt;img src=&apos;${address}/img/sample_jnd_strip.png&apos;&gt;&lt;/img&gt;&lt;/div&gt;` +
          &quot;&lt;strong&gt;Press the M key if the graph &lt;u&gt;below&lt;/u&gt; is more correlated.&lt;/strong&gt;&quot;
      };
    }
    break;

  case &quot;ring&quot;:
    var instructions = {
    type: &quot;html-keyboard-response&quot;,
    stimulus: &quot;&lt;div align = &apos;center&apos;&gt; &lt;p&gt;In this experiment, two graphs will appear one on top of the other.&quot; + 
        &quot;&lt;br&gt; Indicate which graph is more correlated by pressing the Z or M key. &lt;/p&gt;&lt;p&gt;&quot; +
        &quot;&lt;strong&gt;Press the Z key if the graph &lt;u&gt;above&lt;/u&gt; is more correlated.&lt;/strong&gt;&quot; +
        `&lt;div style=&apos;float: center; display: block;&apos;&gt;&lt;img src=&apos;${address}/img/sample_jnd_ring.png&apos;&gt;&lt;/img&gt;&lt;/div&gt;` +
        &quot;&lt;strong&gt;Press the M key if the graph &lt;u&gt;below&lt;/u&gt; is more correlated.&lt;/strong&gt;&quot;
    };
    break;  
}

var ready = {
  type: &apos;html-keyboard-response&apos;,
  stimulus: &quot;&lt;div align = &apos;center&apos;&gt; &lt;font size = 20&gt;&lt;p&gt;Ready? We will first do some practice trials. &lt;p&gt;&quot; + &quot;&lt;br&gt;&lt;br&gt;&lt;p&gt;&lt;b&gt;Press any key to begin.&lt;/b&gt;&lt;/p&gt;&lt;/font&gt;&lt;/div&gt;&quot;,
  data: {type: &apos;instruction&apos;}
}

var instruction_trials = {
  timeline: [instructions, ready]
};

timeline.push(instruction_trials);

// =========================================================
// PRACTICE TRIAL BLOCKS

// ---------------------------------------------------------
// FEEDBACK

var feedback = {
  type: &apos;html-keyboard-response&apos;,
  // choices: jsPsych.NO_KEYS, //No responses will be accepted as a valid response.
  // trial_duration: 500,
  data: {type: &apos;feedback&apos;},
  stimulus: function(){

    document.body.style.backgroundColor = jnd_exp.trial_data.feedback_background_color;

    var last_trial = JSON.parse(jsPsych.data.getLastTrialData().json());
    var last_trial_correct = last_trial[0][&quot;correct&quot;];

    // For debugging purposes:
    if (last_trial_correct == -1){
      return &apos;&lt;p&gt;&apos; + 
             &apos;&lt;font style=&quot;font-size:50px; color:blue&quot;&gt;Exiting from experiment.&lt;p&gt;&lt;/font&gt;&apos;
    }

    else if (last_trial_correct){
      return &apos;&lt;p&gt;&lt;i class=&quot;fa fa-check-circle&quot; style=&quot;font-size:50px; color:green; margin-right: 10px;&quot;&gt;&lt;/i&gt;&apos; + 
             &apos;&lt;font style=&quot;font-size:50px; color:green&quot;&gt;Correct!&lt;p&gt;&lt;/font&gt;&apos;
    }
    else{
      return &apos;&lt;p&gt;&lt;i class=&quot;fa fa-close&quot; style=&quot;font-size:50px; color:red; margin-right: 10px;&quot;&gt;&lt;/i&gt;&apos; + 
             &apos;&lt;font style=&quot;font-size:50px; color:red;&quot;&quot;&gt;Incorrect!&lt;p&gt;&lt;/font&gt;&apos;
    }
  }
};

// ---------------------------------------------------------
// PRACTICE TIMELINE

var practice_jnd = jnd_exp.generate_trial(&quot;practice&quot;);

var practice = {
  timeline: [practice_jnd, feedback], // We use same feedback block as that used in practice 
  loop_function: function(data){ // Return true if timeline should continue
                                 // Return false if timeline should end

    // Flag is always true for each trial since we display one trial for 
    // each condition on the practice                              
    jnd_exp.first_trial_of_sub_condition = true;

    // For debugging, if you want to exit out of experiment, press q:
    if (jsPsych.pluginAPI.convertKeyCharacterToKeyCode(&apos;q&apos;) == data.values()[0].key_press){
      // Turn flag on 
      jnd_exp.first_trial_of_sub_condition = true;
      return false;
    }

    // If there are still more practice conditions, increment current index
    if (jnd_exp.current_practice_condition_index &lt; (jnd_exp.practice_conditions_constants.length-1)){
      jnd_exp.current_practice_condition_index++; 
      console.log(&quot;!!!!!!!!!! Moved to new practice condition at index &quot; 
                  + jnd_exp.current_practice_condition_index);
      return true; 
    }
    // Else end experiment
    else{
      // Turn flag on 
      jnd_exp.first_trial_of_sub_condition = true;
      return false;
    }
  }
};

timeline.push(practice);

// ---------------------------------------------------------
// STOP BLOCK

var stop = {
  type: &apos;html-keyboard-response&apos;,
  stimulus: &quot;&lt;div align = &apos;center&apos;&gt; &lt;font size = 20&gt;&lt;p&gt;This concludes the practice trials.&lt;p&gt;&quot; + &quot;&lt;br&gt;&lt;br&gt;&lt;p&gt;&lt;b&gt;Any questions?&lt;/b&gt;&lt;/p&gt;&lt;/font&gt;&lt;/div&gt;&quot;,
  data: {type: &apos;instruction&apos;},
  on_start: function(stop){
    // Reset background color to feedback
    document.body.style.backgroundColor = jnd_exp.trial_data.feedback_background_color;
  }
}

var ready_experiment = {
  type: &apos;html-keyboard-response&apos;,
  stimulus: &quot;&lt;div align = &apos;center&apos;&gt; &lt;font size = 20&gt;&lt;p&gt;Ready?&lt;p&gt;&quot; + &quot;&lt;br&gt;&lt;br&gt;&lt;p&gt;&lt;b&gt;Press any key to begin.&lt;/b&gt;&lt;/p&gt;&lt;/font&gt;&lt;/div&gt;&quot;,
  data: {type: &apos;instruction&apos;}
}

var stop_trials = {
  timeline: [stop, ready_experiment]
};

timeline.push(stop_trials);

// =========================================================
// EXPERIMENT TRIAL BLOCKS

var trial = jnd_exp.generate_trial(&quot;test&quot;);

var experiment = {
  timeline: [trial, feedback], // We use same feedback block as that used in practice 
  loop_function: function(data){ // Return true if timeline should continue
                                 // Return false if timeline should end

    // For debugging, if you want to exit out of experiment, press q:
    if (jsPsych.pluginAPI.convertKeyCharacterToKeyCode(&apos;q&apos;) == data.values()[0].key_press){
      return false;
    }

    // If subcondition should end:
    if(jnd_exp.end_sub_condition()){
      jnd_exp.first_trial_of_sub_condition = true;
      // If there are still more subconditions, increment current index
      if (jnd_exp.current_sub_condition_index &lt; (jnd_exp.sub_conditions_constants.length-1)){
        jnd_exp.current_sub_condition_index++; 
        console.log(&quot;!!!!!!!!!! Moved to new sub condition at index &quot; 
                    + jnd_exp.current_sub_condition_index);
        return true; 
      }
      // Else end experiment
      else{
        return false;
      }
    } 
    // Else continue w/ current subcondition:
    else {
      return true;
    }
  },
  on_finish: function(data){
    jnd_exp.trial_data = data; 
  }
};

timeline.push(experiment);

console.log(&quot;======================&quot;);

// =========================================================
// DATA DOWNLOADING 

var experiment_end = {
  type: &apos;html-keyboard-response&apos;,
  stimulus: &apos;&lt;div align = &quot;center&quot;&gt;&apos; + 
            &apos;&lt;p&gt;&lt;font size = 10&gt;You have completed the experiment!&lt;p&gt;&lt;/font&gt;&apos; +
            &apos;&lt;br&gt;&apos; +
            &apos;Trial and summary data files will now automatically download locally.&apos; + 
            &apos;&lt;/div&gt;&apos; ,
  on_start: function(){

    jnd_exp.export_trial_data();
    jnd_exp.export_summary_data();
    
    // Reset background color to feedback
    document.body.style.backgroundColor = jnd_exp.trial_data.feedback_background_color;
  }
};
timeline.push(experiment_end);

// =========================================================
// START JSPSYCH

jsPsych.init({
    timeline: timeline,
    on_finish: function(){ 
        jsPsych.data.displayData();
    }
});</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.1.0)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
