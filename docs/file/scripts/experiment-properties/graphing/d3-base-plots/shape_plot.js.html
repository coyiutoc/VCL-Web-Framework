<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../../../../">
  <title data-ice="title">scripts/experiment-properties/graphing/d3-base-plots/shape_plot.js | VCL Framework</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
<script src="./inject/script/0-conditions-config.js"></script><script src="./inject/script/0-experiments-config.js"></script><script src="./inject/script/0-graphing-config.js"></script><script src="./inject/script/0-trial-structure-config.js"></script><script src="./inject/script/0-balancing-config.js"></script><script src="./inject/script/0-view-controller.js"></script><script src="./inject/script/0-experiments-renderer.js"></script><script src="./inject/script/0-conditions-renderer.js"></script><script src="./inject/script/0-supported-properties-renderer.js"></script><link rel="stylesheet" href="./inject/css/0-styles.css"><meta name="description" content="This is a Node.js application that runs proof of concept experiments for the following:"><meta property="twitter:card" content="summary"><meta property="twitter:title" content="VCL Framework"><meta property="twitter:description" content="This is a Node.js application that runs proof of concept experiments for the following:"></head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
<a style="position:relative; top:3px;" href="https://github.com/coyiutoc/VCL_Correlation_POC"><img width="20px" src="./image/github.png"></a></header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#experiment-properties-balancing">experiment-properties/balancing</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-balance_subconditions">balance_subconditions</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#experiment-properties-balancing-generators">experiment-properties/balancing/generators</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-initialize_latin_square">initialize_latin_square</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-initialize_random_order">initialize_random_order</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#experiment-properties-data">experiment-properties/data</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-get_subconditions">get_subconditions</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-create_condition_dataset">create_condition_dataset</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-get_data">get_data</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-get_data_subset">get_data_subset</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-CUSTOM_TRIAL_STRUCTURE_CONDITIONS">CUSTOM_TRIAL_STRUCTURE_CONDITIONS</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-EXPERIMENT_BASES">EXPERIMENT_BASES</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-EXPERIMENT_CONDITIONS">EXPERIMENT_CONDITIONS</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#experiment-properties-data-constants">experiment-properties/data/constants</a><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-ESTIMATION_BASE">ESTIMATION_BASE</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-JND_BASE">JND_BASE</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-JND_CONDITIONS">JND_CONDITIONS</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-JND_RADIUS_BASE">JND_RADIUS_BASE</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-JND_RADIUS_CONDITIONS">JND_RADIUS_CONDITIONS</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-STEVENS_BASE">STEVENS_BASE</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-STEVENS_CONDITIONS">STEVENS_CONDITIONS</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#experiment-properties-graphing">experiment-properties/graphing</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-is_custom_plot">is_custom_plot</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-prepare_custom_plot">prepare_custom_plot</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-plot_distributions">plot_distributions</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#experiment-properties-graphing-d3-base-plots">experiment-properties/graphing/d3-base-plots</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-create_ring_plot">create_ring_plot</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-create_scatter_plot">create_scatter_plot</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-plot_scatter_points">plot_scatter_points</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-create_shape_plot">create_shape_plot</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-create_strip_plot">create_strip_plot</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#experiment-properties-graphing-d3-custom-plots">experiment-properties/graphing/d3-custom-plots</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-create_distractor_scatter_plot">create_distractor_scatter_plot</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#experiments-estimation">experiments/estimation</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/scripts/experiments/estimation/estimation.js~Estimation.html">Estimation</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-estimation_exp">estimation_exp</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#experiments-jnd">experiments/jnd</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/scripts/experiments/jnd/jnd.js~JND.html">JND</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-jnd_exp">jnd_exp</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#experiments-jnd-radius">experiments/jnd_radius</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/scripts/experiments/jnd_radius/jnd_radius.js~JND_Radius.html">JND_Radius</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-jnd_radius_exp">jnd_radius_exp</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#experiments-stevens">experiments/stevens</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/scripts/experiments/stevens/stevens.js~Stevens.html">Stevens</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-stevens_exp">stevens_exp</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#helpers">helpers</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-force_greater_right_position">force_greater_right_position</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-randomize_position">randomize_position</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-randomize_radius_position">randomize_radius_position</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">scripts/experiment-properties/graphing/d3-base-plots/shape_plot.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">export {create_shape_plot};

/**
 * D3 code for setting up shape plot chart area
 *
 * @param {object}   attributes
 */
function create_shape_plot(attributes) {

  let radius = attributes[&quot;curr_radius&quot;];
  let max_radius = attributes[&quot;max_radius&quot;];
  let min_radius = attributes[&quot;min_radius&quot;];
  let properties = attributes[&quot;graph_attributes&quot;];

  let diff = max_radius - min_radius;

  // SVG dimensions
  let height = max_radius*2; 
  let width = max_radius*2;

  // Margin calculations
  let width_diff = (1/4)*window.innerWidth - max_radius;

  let margin_top;

  // Firefox check (doesn&apos;t handle JsPsych formatting well)
  if (typeof InstallTrigger !== &apos;undefined&apos;) {
    let margin_top = window.innerHeight/2 - max_radius;
  } else {
    let margin_top = 0;
  }

  var chart = d3.select(&quot;#graph&quot;) 
                 .append(&quot;svg&quot;) 
                  .attr(&quot;width&quot;, width) 
                  .attr(&quot;height&quot;, height)
                  .attr(&quot;style&quot;, `margin-right: ${width_diff}; margin-left: ${width_diff}; margin-top: ${margin_top}`);

  // var GRAPH_TYPES comes from /config/graphing-config.js
  if (!GRAPH_TYPES[&quot;shapes&quot;][&quot;attributes&quot;][&quot;shapes&quot;][&quot;valid_inputs&quot;].includes(properties[&quot;shapes&quot;])){
    throw Error(&quot; &quot; + shape_type + &quot; is not a valid shape for graph type shapes.&quot;);
  }

  // Plot depending on shape specified
  switch (properties[&quot;shapes&quot;]){
    
    case &quot;slice&quot;:
      let degrees = properties[&quot;slice_rotation&quot;];
      plot_slice(chart, radius, degrees, max_radius, diff, properties);
      break;

    case &quot;square&quot;:
      plot_square(chart, radius, max_radius, diff, properties);
      break;

    case &quot;rotSquare&quot;:
      plot_rotated_square(chart, radius, max_radius, diff, properties);
      break;

    case &quot;triangle&quot;:
      plot_triangle(chart, radius, max_radius, diff, properties);
      break;

    case &quot;rotTriangle&quot;:
      plot_rotated_triangle(chart, radius, max_radius, diff, properties);
      break;

    default:
      plot_circle(chart, radius, max_radius, diff, properties);
      break;
  }

}

/**
 * D3 code for plotting a circle.
 *
 * @param  chart      {svg object}
 *         radius     {double} 
 *         max_radius {double}     Largest radius of the given trial
 *         diff       {double}     Difference between max and min radius of given trial        
 */ 
function plot_circle(chart, radius, max_radius, diff, properties) {

  let translation = radius;

  // If radius is the smaller one, need to adjust translation
  if (radius !== max_radius) {
    translation += diff;
  }

  // Move the origin to center of SVG
  let g = chart.append(&quot;g&quot;)
               .attr(&quot;transform&quot;, &quot;translate(&quot; + translation + &quot;,&quot; + translation + &quot;)&quot;);

  // Generate the pie
  let pie = d3.pie();

  // Generate the arcs
  let arc = d3.arc()
              .innerRadius(0)
              .outerRadius(radius/2);

  // Represents the % that each slice takes up - so this is a pie with 4 &quot;parts&quot;.
  let data = [25, 25, 25, 25];
  
  // Generate groups
  let arcs = g.selectAll(&quot;arc&quot;)
              .data(pie(data))
              .enter()
              .append(&quot;g&quot;)
              .attr(&quot;class&quot;, &quot;arc&quot;)

  // Draw arc paths
  arcs.append(&quot;path&quot;)
      .attr(&quot;fill&quot;, function(d, i) {
        return properties[&quot;fill_color&quot;];
      })
      .attr(&quot;stroke&quot;, function(d, i) {
        return properties[&quot;stroke_color&quot;];
      })
      .attr(&quot;d&quot;, arc);
}

/**
 * D3 code for plotting a slice (1/4 of circle).
 *      
 * @param  chart      {svg object}
 *         radius     {double} 
 *         rotation   {int}        Degrees of rotation in the counterclockwise direction.        
 *         max_radius {double}     Largest radius of the given trial
 *         diff       {double}     Difference between max and min radius of given trial  
 *         properties {object}     Graph attributes extracted from constants
 */ 
function plot_slice(chart, radius, rotation, max_radius, diff, properties) {

  let translation = 0;

  // If radius is the smaller one, need to adjust translation
  if (radius !== max_radius) {
    translation = 0.5*diff;
  }

  // Move the origin to center of SVG
  let g = chart.append(&quot;g&quot;)
               .attr(&quot;transform&quot;, function() {
                 if (rotation === 0) {
                   return &quot;translate(&quot; + (max_radius/2 + translation) + &quot;,&quot; + (1.5*radius + translation) + &quot;)&quot;;
                 } 
                 else if (rotation === 90) {
                   return &quot;translate(&quot; + (max_radius*1.5 + translation) + &quot;,&quot; + (1.5*radius + translation) + &quot;)&quot;;
                 }
                 // This is assuming the object is centered
                 else {
                   return &quot;translate(&quot; + (max_radius + translation) + &quot;,&quot; + (1.5*radius + translation) + &quot;)&quot;;
                 }
               });

  // Generate the pie
  let pie = d3.pie();

  // Generate the arcs
  let arc = d3.arc()
              .innerRadius(0)
              .outerRadius(radius);

  // Represents the % that each slice takes up - so this is a pie with 4 &quot;parts&quot;.
  let data = [25, 25, 25, 25];
  
  // Generate groups
  let arcs = g.selectAll(&quot;arc&quot;)
              .data(pie(data))
              .enter()
              .append(&quot;g&quot;)
              .attr(&quot;class&quot;, &quot;arc&quot;)

  arcs.append(&quot;path&quot;)
      .attr(&quot;fill&quot;, function(d, i) {
          if (i === 0) {
              return properties[&quot;fill_color&quot;];
          } else {
              return &quot;#ffffff&quot;;
          }    
      })
      .attr(&quot;stroke&quot;, function(d, i) {
        return properties[&quot;stroke_color&quot;];
      })
      .attr(&quot;d&quot;, arc)
      .attr(&quot;transform&quot;, &quot;rotate(&quot; + (-1)*rotation + &quot;)&quot;);
}

/**
 * D3 code for plotting a square.
 *
 * @param  chart      {svg object}
 *         radius     {double} 
 *         max_radius {double}     Largest radius of the given trial
 *         diff       {double}     Difference between max and min radius of given trial  
 *         properties {object}     Graph attributes extracted from constants       
 */ 
function plot_square(chart, radius, max_radius, diff, properties) {

  let translation = 0.5*max_radius;

  // If radius is the smaller one, need to adjust translation
  if (radius !== max_radius) {
    translation = 0.5*max_radius + 0.5*diff;
  }

  let g = chart.append(&quot;g&quot;);

  let rect = g.append(&quot;rect&quot;)
                 .attr(&quot;x&quot;, 0)
                 .attr(&quot;y&quot;, 0)
                 .attr(&quot;width&quot;, radius)
                 .attr(&quot;height&quot;, radius)
                 .attr(&quot;fill&quot;, properties[&quot;fill_color&quot;])
                 .attr(&quot;stroke&quot;, properties[&quot;stroke_color&quot;])
                 .attr(&quot;transform&quot;, &quot;translate(&quot; + translation + &quot;,&quot; + translation + &quot;)&quot;);
}

/**
 * D3 code for plotting a rotated square AKA diamond.
 *
 * @param  chart      {svg object}
 *         radius     {double} 
 *         max_radius {double}     Largest radius of the given trial
 *         diff       {double}     Difference between max and min radius of given trial   
 *         properties {object}     Graph attributes extracted from constants     
 */ 
function plot_rotated_square(chart, radius, max_radius, diff, properties) {

  let xtranslation = radius;
  let ytranslation = 0.25*radius;

  // If radius is the smaller one, need to adjust translation
  if (radius !== max_radius) {
    xtranslation += 0.5*diff;
    ytranslation += diff;
  }

  let g = chart.append(&quot;g&quot;);
            
  let rect = g.append(&quot;rect&quot;)
                 .attr(&quot;x&quot;, 0)
                 .attr(&quot;y&quot;, 0)
                 .attr(&quot;width&quot;, radius)
                 .attr(&quot;height&quot;, radius)
                 .attr(&quot;fill&quot;, properties[&quot;fill_color&quot;])
                 .attr(&quot;stroke&quot;, properties[&quot;stroke_color&quot;])
                 .attr(&quot;transform&quot;, &quot;translate(&quot; + xtranslation + &quot;,&quot; + ytranslation + &quot;) rotate(45)&quot;);
}

/**
 * D3 code for plotting a triangle.
 *
 * @param  chart      {svg object}
 *         radius     {double} 
 *         max_radius {double}     Largest radius of the given trial
 *         diff       {double}     Difference between max and min radius of given trial   
 *         properties {object}     Graph attributes extracted from constants     
 */ 
function plot_triangle(chart, radius, max_radius, diff, properties) {

  let translation = 0;

  // If radius is the smaller one, need to shift by the 0.5*diff
  if (radius !== max_radius) {
    translation = diff;
  }

  let poly = [{&quot;x&quot;:(0.5*radius + translation), &quot;y&quot;:(0.5*radius + translation)},
              {&quot;x&quot;:(0.5*radius + translation), &quot;y&quot;:(1.5*radius + translation)},
              {&quot;x&quot;:(1.5*radius + translation), &quot;y&quot;:(1.5*radius + translation)}];

  chart.selectAll(&quot;polygon&quot;)
       .data([poly])
       .enter().append(&quot;polygon&quot;)
       .attr(&quot;points&quot;,function(d) { 
          return d.map(function(d) { return [d.x, d.y].join(&quot;,&quot;); }).join(&quot; &quot;);})
       .attr(&quot;fill&quot;, properties[&quot;fill_color&quot;])
       .attr(&quot;stroke&quot;, properties[&quot;stroke_color&quot;]);
}

/**
 * D3 code for plotting a rotated triangle.
 *
 * @param  chart      {svg object}
 *         radius     {double} 
 *         max_radius {double}     Largest radius of the given trial
 *         diff       {double}     Difference between max and min radius of given trial 
 *         properties {object}     Graph attributes extracted from constants       
 */ 
function plot_rotated_triangle(chart, radius, max_radius, diff, properties) {

  let translation = 0;

  // If radius is the smaller one, need to shift by the 0.5*diff
  if (radius !== max_radius) {
    translation = diff;
  }

  let poly = [{&quot;x&quot;:(1.5*radius + translation), &quot;y&quot;:(0.5*radius + translation)},
              {&quot;x&quot;:(0.5*radius + translation), &quot;y&quot;:(radius + translation)},
              {&quot;x&quot;:(1.5*radius + translation), &quot;y&quot;:(1.5*radius + translation)}];

  chart.selectAll(&quot;polygon&quot;)
       .data([poly])
       .enter().append(&quot;polygon&quot;)
       .attr(&quot;points&quot;,function(d) { 
          return d.map(function(d) { return [d.x, d.y].join(&quot;,&quot;); }).join(&quot; &quot;);})
       .attr(&quot;fill&quot;, properties[&quot;fill_color&quot;])
       .attr(&quot;stroke&quot;, properties[&quot;stroke_color&quot;]);      
}
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.1.0)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
